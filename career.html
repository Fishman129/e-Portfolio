<!doctype html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" href="favicon.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Career — Alessandro Cervantes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --bg1:linear-gradient(120deg,#071429 0%, #0b2b3a 35%, #0f3b2f 100%); --glass:rgba(255,255,255,0.06); --accent:#6be3b6; --muted:rgba(255,255,255,0.7) }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:#eef6f5;-webkit-font-smoothing:antialiased}
    .site{min-height:100vh;display:flex;flex-direction:column}
    header{backdrop-filter:blur(6px);background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));position:sticky;top:0;z-index:40;border-bottom:1px solid rgba(255,255,255,0.03)}
    nav{display:flex;align-items:center;justify-content:space-between;padding:18px 36px;max-width:1200px;margin:0 auto}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{width:54px;height:54px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#4bd8ff);display:flex;align-items:center;justify-content:center;color:#042;font-weight:800;font-family:'Playfair Display';box-shadow:0 6px 18px rgba(11,22,30,0.6)}
    .brand h1{margin:0;font-family:'Playfair Display';font-weight:700;letter-spacing:0.6px}
    .brand p{margin:0;color:var(--muted);font-size:13px}
    .nav-links{display:flex;gap:12px;align-items:center}
    .btn{padding:10px 14px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);cursor:pointer;font-weight:600;transition:all .2s}
    .btn.primary{background:linear-gradient(90deg,var(--accent),#4bd8ff);color:#022;border:none;box-shadow:0 8px 30px rgba(11,22,30,0.45)}
    .btn:hover{transform:scale(1.05)}
    .btn.active{border-color:var(--accent);color:#eafdf7}
    main{max-width:1200px;margin:36px auto;padding:0 36px 80px}
    .section{background:var(--glass);padding:22px;border-radius:14px;border:1px solid rgba(255,255,255,0.03);min-height:120px;opacity:0;transform:translateY(20px);transition:all .8s cubic-bezier(.2,.9,.2,1)}
    .section.show{opacity:1;transform:none}
    .section:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 12px 36px rgba(0,0,0,.35)}
    .section h2{font-family:'Playfair Display';margin:0 0 8px}
    .section p{color:var(--muted);line-height:1.6}
    .bg-animated{position:fixed;inset:0;z-index:-1;pointer-events:none;background:linear-gradient(270deg,#0b2b3a,#0f3b2f,#071429,#123d52);background-size:800% 800%;animation:gradientShift 20s ease infinite}
    @keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    #scroll-bar{position:fixed;top:0;right:20px;width:12px;height:100%;background:rgba(255,255,255,0.05);border-radius:6px;z-index:9999;overflow:hidden}
    #scroll-bar-fill{width:100%;height:0%;background:linear-gradient(180deg,var(--accent),#4bd8ff);border-radius:6px;transition:height .2s}
    html{scrollbar-width:none} body::-webkit-scrollbar{width:0;background:transparent}

    .ppt-card{padding:22px}
    .ppt-actions{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px}
    .ppt-embed{position:relative;width:100%;border-radius:14px;overflow:hidden;box-shadow:0 8px 24px rgba(0,0,0,.4);background:rgba(0,0,0,.25)}
    .ppt-embed::before{content:"";display:block;padding-top:56.25%}
    .ppt-embed iframe, .ppt-embed object{position:absolute;inset:0;width:100%;height:100%;border:0}
    .note{color:var(--muted);font-size:14px;margin-top:10px}
    .hint{font-size:13px;color:#bfeee0;margin-top:8px}
    .warn{color:#ffd5d5}
    .divider{height:1px;background:rgba(255,255,255,0.08);margin:14px 0}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,0.12);font-size:12px;color:#dff7ef}
  </style>
</head>
<body>
  <div class="bg-animated" aria-hidden="true"></div>
  <div id="scroll-bar"><div id="scroll-bar-fill"></div></div>

  <div class="site">
    <header>
      <nav>
        <div class="brand">
          <div class="logo">AC</div>
          <div>
            <h1>Alessandro Cervantes</h1>
            <p>E-Portfolio</p>
          </div>
        </div>
        <div class="nav-links">
          <button class="btn primary" id="contactBtn">Contact</button>
          <button class="btn" onclick="window.location='index.html'">Home</button>
          <button class="btn" onclick="window.location='marketable.html'">Marketable Skills</button>
          <button class="btn" onclick="window.location='community.html'">Community Engagement</button>
          <button class="btn active" onclick="window.location='career.html'">Career</button>
        </div>
      </nav>
    </header>

    <main>
      <h1 style="text-align:center;font-family:'Playfair Display';font-size:42px;margin-bottom:24px;">
        <span id="pageTitle">Career</span>
      </h1>

      <section class="section ppt-card">
        <h2>Political Science Career Project</h2>

        <div class="ppt-actions">
          <a id="downloadBtn" class="btn" href="Career_Project_Political_Science.pptx" download>Download .pptx</a>
          <a id="openOffice" class="btn">Open in Office Viewer</a>
          <a id="openGView" class="btn">Open in Google Viewer</a>
          <a id="openPDF" class="btn">Open PDF (if available)</a>
        </div>

        <div class="ppt-embed" id="pptEmbed"></div>

        <div class="note">
          <span class="badge">Tip</span>
          If you’re running this locally (file://), most online viewers can’t read your file. Host these files on your web host or a public link (OneDrive/Google Drive)
          and they’ll render.
        </div>
        <div class="divider"></div>
        <div class="hint">
          If embedding fails: export a PDF named <code>Career_Project_Political_Science.pdf</code> into the same folder and the page will auto-use it.
        </div>
        <div class="hint warn" id="statusMsg" style="display:none"></div>
      </section>
    </main>

    <footer>
      <div style="text-align:center;padding:20px 0;color:var(--muted)">
        © <strong>Alessandro Cervantes</strong> — E-Portfolio
      </div>
    </footer>
  </div>

  <script>
    // Reveal animation
    function reveal(){ document.querySelectorAll('.section').forEach((el,i)=>setTimeout(()=>el.classList.add('show'), i*200)); }
    window.addEventListener('load',reveal);

    // Typewriter for title
    (function(){
      const titleEl = document.getElementById('pageTitle');
      const t = titleEl.textContent.trim(); titleEl.textContent = '';
      let i=0; const h=setInterval(()=>{ titleEl.textContent += t.charAt(i++); if(i>=t.length) clearInterval(h); },40);
    })();

    // Scroll progress bar
    const scrollBarFill=document.getElementById('scroll-bar-fill');
    window.addEventListener('scroll',()=>{ const st=window.scrollY, dh=document.body.scrollHeight-window.innerHeight; scrollBarFill.style.height=(st/dh)*100+'%'; });

    // Contact anchor
    document.getElementById('contactBtn').addEventListener('click',()=>{ window.location.href='index.html#contact'; });

    // ---------- Robust PPT embedding pipeline ----------
    (function(){
      const fileBase = 'Career_Project_Political_Science';
      const pptx = fileBase + '.pptx';
      const pdf  = fileBase + '.pdf';

      const embed = document.getElementById('pptEmbed');
      const status = document.getElementById('statusMsg');

      const absolute = new URL(pptx, window.location.href).href;
      const officeEmbed = 'https://view.officeapps.live.com/op/embed.aspx?src=' + encodeURIComponent(absolute);
      const officeView  = 'https://view.officeapps.live.com/op/view.aspx?src='  + encodeURIComponent(absolute);
      const gviewEmbed  = 'https://docs.google.com/gview?embedded=1&url=' + encodeURIComponent(absolute);

      // Buttons
      document.getElementById('downloadBtn').href = pptx;
      document.getElementById('openOffice').href = officeView;
      document.getElementById('openOffice').target = '_blank';
      document.getElementById('openGView').href = gviewEmbed;
      document.getElementById('openGView').target = '_blank';
      document.getElementById('openPDF').href = pdf;
      document.getElementById('openPDF').target = '_blank';

      // Helper: clear + mount node
      function mount(node){ embed.innerHTML=''; embed.appendChild(node); }

      // Try 1: Office Web Viewer
      function tryOffice(){
        const iframe = document.createElement('iframe');
        iframe.src = officeEmbed;
        iframe.setAttribute('allowfullscreen','true');
        iframe.referrerPolicy = 'no-referrer-when-downgrade';
        let ok=false;
        const t = setTimeout(()=>{ if(!ok) tryGoogle(); }, 2500);
        iframe.onload = ()=>{ ok=true; clearTimeout(t); /* may still be blank if blocked; user has buttons */ };
        iframe.onerror = ()=>{ clearTimeout(t); tryGoogle(); };
        mount(iframe);
        status.style.display='block';
        status.textContent='Trying Office Web Viewer…';
      }

      // Try 2: Google Docs Viewer
      function tryGoogle(){
        const iframe = document.createElement('iframe');
        iframe.src = gviewEmbed;
        let ok=false;
        const t = setTimeout(()=>{ if(!ok) tryPDF(); }, 2500);
        iframe.onload = ()=>{ ok=true; clearTimeout(t); };
        iframe.onerror = ()=>{ clearTimeout(t); tryPDF(); };
        mount(iframe);
        status.style.display='block';
        status.textContent='Office viewer blocked/unavailable. Falling back to Google Viewer…';
      }

      // Try 3: Local PDF if present
      function tryPDF(){
        fetch(pdf, {method:'HEAD'}).then(r=>{
          if(r.ok){
            const iframe = document.createElement('iframe');
            iframe.src = pdf + '#view=fitH';
            mount(iframe);
            status.textContent='Using local PDF fallback.';
          }else{
            tryObject();
          }
        }).catch(()=> tryObject());
      }

      // Try 4: Direct object embed (may prompt download)
      function tryObject(){
        const obj = document.createElement('object');
        obj.type = 'application/vnd.openxmlformats-officedocument.presentationml.presentation';
        obj.data = pptx;
        obj.innerHTML = '<p style="padding:16px">Preview unavailable. <a href="'+pptx+'">Download the presentation</a>.</p>';
        mount(obj);
        status.textContent='Preview blocked by host or private file. Use the buttons above.';
      }

      tryOffice();

      // Friendly guidance if running from file://
      if (location.protocol === 'file:'){
        status.style.display='block';
        status.innerHTML = 'You are viewing this locally. Online viewers cannot read local files. <br>Upload both <code>'+pptx+'</code> (and optional <code>'+pdf+'</code>) to your web host or a public link (OneDrive/Google Drive), then open this page via https.';
      }
    })();
  </script>
</body>
</html>