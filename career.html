<!doctype html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" href="favicon.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Career — Alessandro Cervantes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:linear-gradient(120deg,#071429 0%, #0b2b3a 35%, #0f3b2f 100%);
      --glass:rgba(255,255,255,0.06);
      --accent:#6be3b6; --muted:rgba(255,255,255,0.7);
      --ratio:56.25%;     /* container ratio: height/width * 100%  (16:9 default) */
      --zoom:1;           /* scaling when in "cover" mode */
      --fit:contain;      /* contain | cover (we emulate cover with scale) */
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:#eef6f5;-webkit-font-smoothing:antialiased}
    .site{min-height:100vh;display:flex;flex-direction:column}
    header{backdrop-filter:blur(6px);background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));position:sticky;top:0;z-index:40;border-bottom:1px solid rgba(255,255,255,0.03)}
    nav{display:flex;align-items:center;justify-content:space-between;padding:18px 36px;max-width:1200px;margin:0 auto}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{width:54px;height:54px;border-radius:12px;background:linear-gradient(135deg,var(--accent), #4bd8ff);display:flex;align-items:center;justify-content:center;color:#042;font-weight:800;font-family:'Playfair Display';box-shadow:0 6px 18px rgba(11,22,30,0.6)}
    .brand h1{margin:0;font-family:'Playfair Display';font-weight:700;letter-spacing:0.6px}
    .brand p{margin:0;color:var(--muted);font-size:13px}
    .nav-links{display:flex;gap:12px;align-items:center}
    .btn{padding:10px 14px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);cursor:pointer;font-weight:600;transition:all .2s}
    .btn.primary{background:linear-gradient(90deg,var(--accent),#4bd8ff);color:#022;border:none;box-shadow:0 8px 30px rgba(11,22,30,0.45)}
    .btn:hover{transform:scale(1.05)}
    .btn.active{border-color:var(--accent);color:#eafdf7}
    main{max-width:1200px;margin:36px auto;padding:0 36px 80px}
    .section{background:var(--glass);padding:22px;border-radius:14px;border:1px solid rgba(255,255,255,0.03);min-height:120px;opacity:0;transform:translateY(20px);transition:all .8s cubic-bezier(.2,.9,.2,1)}
    .section.show{opacity:1;transform:none}
    .section:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 12px 36px rgba(0,0,0,.35)}
    .section h2{font-family:'Playfair Display';margin:0 0 8px}
    .section p{color:var(--muted);line-height:1.6}
    .bg-animated{position:fixed;inset:0;z-index:-1;pointer-events:none;background:linear-gradient(270deg,#0b2b3a,#0f3b2f,#071429,#123d52);background-size:800% 800%;animation:gradientShift 20s ease infinite}
    @keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    #scroll-bar{position:fixed;top:0;right:20px;width:12px;height:100%;background:rgba(255,255,255,0.05);border-radius:6px;z-index:9999;overflow:hidden}
    #scroll-bar-fill{width:100%;height:0%;background:linear-gradient(180deg,var(--accent),#4bd8ff);border-radius:6px;transition:height .2s}
    html{scrollbar-width:none} body::-webkit-scrollbar{width:0;background:transparent}

    .ppt-card{padding:22px}
    .ppt-actions{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:12px}
    .ppt-actions .spacer{flex:1}
    .ppt-embed{
      position:relative;width:100%;border-radius:14px;background:#fff; /* white kills any viewer black padding */
      box-shadow:0 8px 24px rgba(0,0,0,.4);overflow:hidden;
    }
    .ppt-embed::before{content:"";display:block;padding-top:var(--ratio)} /* responsive aspect box */
    .viewer-wrap{
      position:absolute;inset:0;display:grid;place-items:center;background:#fff; /* no black edges */
      overflow:hidden;
    }
    .viewer{
      width:100%;height:100%;border:0;background:#fff;border-radius:0; /* square inside */
      transform:scale(var(--zoom)); transform-origin:center center; /* used for “cover” mode */
    }
    /* We simulate "contain" by zoom=1 and "cover" by zoom>1 (user controlled). */
    .note{color:var(--muted);font-size:13px;margin-top:8px}
    .warn{color:#ffd5d5}
    .controls-small{display:flex;gap:6px;flex-wrap:wrap;align-items:center}
    .control-input{display:flex;gap:6px;align-items:center}
    .control-input input{width:70px;padding:6px 8px;border-radius:8px;border:1px solid rgba(255,255,255,0.12);background:rgba(0,0,0,0.2);color:#e8fff7}
    .control-range{display:flex;gap:8px;align-items:center}
    .control-range input[type="range"]{width:160px}
  </style>
</head>
<body>
  <div class="bg-animated" aria-hidden="true"></div>
  <div id="scroll-bar"><div id="scroll-bar-fill"></div></div>

  <div class="site">
    <header>
      <nav>
        <div class="brand">
          <div class="logo">AC</div>
          <div>
            <h1>Alessandro Cervantes</h1>
            <p>E-Portfolio</p>
          </div>
        </div>
        <div class="nav-links">
          <button class="btn primary" id="contactBtn">Contact</button>
          <button class="btn" onclick="window.location='index.html'">Home</button>
          <button class="btn" onclick="window.location='marketable.html'">Marketable Skills</button>
          <button class="btn" onclick="window.location='community.html'">Community Engagement</button>
          <button class="btn active" onclick="window.location='career.html'">Career</button>
        </div>
      </nav>
    </header>

    <main>
      <h1 style="text-align:center;font-family:'Playfair Display';font-size:42px;margin-bottom:24px;">
        <span id="pageTitle">Career</span>
      </h1>

      <section class="section ppt-card">
        <h2>Political Science Career Project</h2>

        <div class="ppt-actions">
          <a id="downloadBtn" class="btn" href="Career_Project_Political_Science.pptx" download>Download .pptx</a>
          <a id="openOffice" class="btn">Open in Office Viewer</a>
          <a id="openGView" class="btn">Open in Google Viewer</a>
          <a id="openPDF" class="btn">Open PDF</a>
          <span class="spacer"></span>

          <!-- Aspect presets -->
          <div class="controls-small">
            <span class="btn" data-preset="16:9">16:9</span>
            <span class="btn" data-preset="16:10">16:10</span>
            <span class="btn" data-preset="3:2">3:2</span>
            <span class="btn" data-preset="4:3">4:3</span>
            <span class="btn" data-preset="5:4">5:4</span>
            <span class="btn" data-preset="1:1">1:1</span>
            <span class="btn" data-preset="A">A-series</span>
          </div>

          <!-- Custom ratio + Fit mode + Zoom -->
          <div class="controls-small">
            <div class="control-input">
              <label>Custom:</label>
              <input id="ratioW" type="number" min="1" step="1" placeholder="W">
              <span>:</span>
              <input id="ratioH" type="number" min="1" step="1" placeholder="H">
              <button class="btn" id="applyCustom">Set</button>
            </div>
            <div class="control-input">
              <label>Fit:</label>
              <select id="fitMode" class="btn" style="padding:8px 10px">
                <option value="contain" selected>Contain (no crop)</option>
                <option value="cover">Cover (fill; may crop)</option>
              </select>
            </div>
            <div class="control-range" id="zoomCtl" style="display:none">
              <label>Zoom</label>
              <input id="zoomRange" type="range" min="100" max="130" value="105">
              <span id="zoomVal">105%</span>
            </div>
          </div>
        </div>

        <div class="ppt-embed" id="pptEmbed">
          <div class="viewer-wrap" id="viewerWrap">
            <!-- iframe mounts here -->
          </div>
        </div>

        <div class="note warn" id="statusMsg" style="display:none"></div>
      </section>
    </main>

    <footer>
      <div style="text-align:center;padding:20px 0;color:var(--muted)">
        © <strong>Alessandro Cervantes</strong> — E-Portfolio
      </div>
    </footer>
  </div>

  <script>
    function reveal(){ document.querySelectorAll('.section').forEach((el,i)=>setTimeout(()=>el.classList.add('show'), i*200)); }
    window.addEventListener('load',reveal);

    // Typewriter
    (function(){ const tEl=document.getElementById('pageTitle'); const t=tEl.textContent.trim(); tEl.textContent=''; let i=0; const h=setInterval(()=>{ tEl.textContent+=t.charAt(i++); if(i>=t.length) clearInterval(h); },40); })();

    // Scroll progress
    const scrollBarFill=document.getElementById('scroll-bar-fill');
    window.addEventListener('scroll',()=>{ const st=window.scrollY, dh=document.body.scrollHeight-window.innerHeight; scrollBarFill.style.height=(st/dh)*100+'%'; });

    document.getElementById('contactBtn').addEventListener('click',()=>{ window.location.href='index.html#contact'; });

    // ---------- Embedding (Office -> Google -> PDF -> Object) + Advanced aspect/cover ----------
    (function(){
      const fileBase = 'Career_Project_Political_Science';
      const pptx = fileBase + '.pptx';
      const pdf  = fileBase + '.pdf';

      const wrap  = document.getElementById('viewerWrap');
      const embed = document.getElementById('pptEmbed');
      const status = document.getElementById('statusMsg');

      // Buttons
      const absolute = new URL(pptx, window.location.href).href;
      const officeEmbed = 'https://view.officeapps.live.com/op/embed.aspx?src='
                          + encodeURIComponent(absolute)
                          + '&em=2&wdAllowInteractivity=1&wdDownloadButton=0&wdProgressiveLoading=1';
      const officeView  = 'https://view.officeapps.live.com/op/view.aspx?src=' + encodeURIComponent(absolute);
      const gviewEmbed  = 'https://docs.google.com/gview?embedded=1&url=' + encodeURIComponent(absolute);

      document.getElementById('downloadBtn').href = pptx;
      document.getElementById('openOffice').href = officeView; document.getElementById('openOffice').target = '_blank';
      document.getElementById('openGView').href = gviewEmbed;  document.getElementById('openGView').target = '_blank';
      document.getElementById('openPDF').href = pdf;           document.getElementById('openPDF').target = '_blank';

      function show(msg){ status.style.display='block'; status.textContent=msg; }
      function clearStatus(){ status.style.display='none'; status.textContent=''; }

      function mount(src){
        wrap.innerHTML='';
        const iframe = document.createElement('iframe');
        iframe.className='viewer';
        iframe.src = src;
        iframe.setAttribute('allowfullscreen','true');
        iframe.referrerPolicy = 'no-referrer-when-downgrade';
        wrap.appendChild(iframe);
        return iframe;
      }

      // Try Office first
      async function run(){
        clearStatus();
        show('Loading Office Web Viewer…');
        let ifr = mount(officeEmbed);
        let ok = await new Promise(res=>{
          let done=false; const to=setTimeout(()=>{ if(!done) res(false); },2500);
          ifr.addEventListener('load',()=>{ done=true; clearTimeout(to); res(true); });
          ifr.addEventListener('error',()=>{ done=true; clearTimeout(to); res(false); });
        });
        if(ok) return;
        // Google fallback
        show('Office viewer unavailable. Trying Google Viewer…');
        ifr = mount(gviewEmbed);
        ok = await new Promise(res=>{
          let done=false; const to=setTimeout(()=>{ if(!done) res(false); },2500);
          ifr.addEventListener('load',()=>{ done=true; clearTimeout(to); res(true); });
          ifr.addEventListener('error',()=>{ done=true; clearTimeout(to); res(false); });
        });
        if(ok) return;
        // PDF fallback
        try{
          const head = await fetch(pdf,{method:'HEAD'});
          if(head.ok){
            show('Using PDF fallback (fit width).');
            mount(pdf + '#view=FitH&zoom=page-width');
            return;
          }
        }catch(_){}
        // Object fallback
        wrap.innerHTML = '<object class="viewer" type="application/vnd.openxmlformats-officedocument.presentationml.presentation" data="'+pptx+'"><p style="padding:16px">Preview unavailable. <a href="'+pptx+'">Download the presentation</a>.</p></object>';
        show('Preview blocked by host or private file. Use the buttons above.');
        if(location.protocol==='file:'){ show('You are viewing this locally. Online viewers cannot read local files. Host via https or export a PDF.'); }
      }
      run();

      // ------- Aspect presets -------
      const presets = {
        '16:9': 9/16,       // ratio = H/W
        '16:10': 10/16,
        '3:2': 2/3,
        '4:3': 3/4,
        '5:4': 4/5,
        '1:1': 1,
        'A': Math.SQRT1_2   // ~0.7071 (H/W) => 70.71%
      };
      document.querySelectorAll('[data-preset]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const key = btn.getAttribute('data-preset');
          const HW = presets[key];
          setRatioPercent(HW * 100);
        });
      });

      // Custom ratio W:H
      function setRatioPercent(percent){ document.documentElement.style.setProperty('--ratio', percent+'%'); }
      document.getElementById('applyCustom').addEventListener('click', ()=>{
        const w = parseFloat(document.getElementById('ratioW').value);
        const h = parseFloat(document.getElementById('ratioH').value);
        if(w>0 && h>0){
          const percent = (h / w) * 100;
          setRatioPercent(percent);
        }
      });

      // Fit mode + Zoom
      const fitMode = document.getElementById('fitMode');
      const zoomCtl = document.getElementById('zoomCtl');
      const zoomRange = document.getElementById('zoomRange');
      const zoomVal = document.getElementById('zoomVal');

      function applyFit(){
        if(fitMode.value === 'cover'){
          zoomCtl.style.display='flex';
          document.documentElement.style.setProperty('--zoom', (parseInt(zoomRange.value,10)/100).toString());
        }else{
          zoomCtl.style.display='none';
          document.documentElement.style.setProperty('--zoom', '1');
        }
      }
      fitMode.addEventListener('change', applyFit);
      zoomRange.addEventListener('input', ()=>{
        zoomVal.textContent = zoomRange.value + '%';
        document.documentElement.style.setProperty('--zoom', (parseInt(zoomRange.value,10)/100).toString());
      });
      applyFit();

    })();
  </script>
</body>
</html>
