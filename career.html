<!doctype html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" href="favicon.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Career — Alessandro Cervantes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:linear-gradient(120deg,#071429 0%, #0b2b3a 35%, #0f3b2f 100%);
      --glass:rgba(255,255,255,0.06); --accent:#6be3b6; --muted:rgba(255,255,255,0.7);
      /* container aspect as height/width * 100%  */
      --ratio:56.25%;      /* default 16:9 */
      /* viewer transforms for “cover” masking */
      --zoom:1;            /* 1.00 – 1.50 typically */
      --shiftX:0px;        /* translateX */
      --shiftY:0px;        /* translateY */
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:#eef6f5;-webkit-font-smoothing:antialiased}
    .site{min-height:100vh;display:flex;flex-direction:column}
    header{backdrop-filter:blur(6px);background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));position:sticky;top:0;z-index:40;border-bottom:1px solid rgba(255,255,255,0.03)}
    nav{display:flex;align-items:center;justify-content:space-between;padding:18px 36px;max-width:1200px;margin:0 auto}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{width:54px;height:54px;border-radius:12px;background:linear-gradient(135deg,var(--accent), #4bd8ff);display:flex;align-items:center;justify-content:center;color:#042;font-weight:800;font-family:'Playfair Display';box-shadow:0 6px 18px rgba(11,22,30,0.6)}
    .brand h1{margin:0;font-family:'Playfair Display';font-weight:700;letter-spacing:0.6px}
    .brand p{margin:0;color:var(--muted);font-size:13px}
    .nav-links{display:flex;gap:12px;align-items:center}
    .btn{padding:10px 14px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);cursor:pointer;font-weight:600;transition:all .2s}
    .btn.primary{background:linear-gradient(90deg,var(--accent),#4bd8ff);color:#022;border:none;box-shadow:0 8px 30px rgba(11,22,30,0.45)}
    .btn:hover{transform:scale(1.05)}
    .btn.active{border-color:var(--accent);color:#eafdf7}
    main{max-width:1200px;margin:36px auto;padding:0 36px 80px}
    .section{background:var(--glass);padding:22px;border-radius:14px;border:1px solid rgba(255,255,255,0.03);min-height:120px;opacity:0;transform:translateY(20px);transition:all .8s cubic-bezier(.2,.9,.2,1)}
    .section.show{opacity:1;transform:none}
    .section:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 12px 36px rgba(0,0,0,.35)}
    .section h2{font-family:'Playfair Display';margin:0 0 8px}
    .section p{color:var(--muted);line-height:1.6}
    .bg-animated{position:fixed;inset:0;z-index:-1;pointer-events:none;background:linear-gradient(270deg,#0b2b3a,#0f3b2f,#071429,#123d52);background-size:800% 800%;animation:gradientShift 20s ease infinite}
    @keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    #scroll-bar{position:fixed;top:0;right:20px;width:12px;height:100%;background:rgba(255,255,255,0.05);border-radius:6px;z-index:9999;overflow:hidden}
    #scroll-bar-fill{width:100%;height:0%;background:linear-gradient(180deg,var(--accent),#4bd8ff);border-radius:6px;transition:height .2s}
    html{scrollbar-width:none} body::-webkit-scrollbar{width:0;background:transparent}

    .ppt-card{padding:22px}
    .ppt-actions{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:12px}
    .spacer{flex:1}
    .controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .controls .group{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .controls input[type="number"]{width:80px;padding:6px 8px;border-radius:8px;border:1px solid rgba(255,255,255,0.12);background:rgba(0,0,0,0.2);color:#e8fff7}
    .controls select{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.12);background:rgba(0,0,0,0.2);color:#e8fff7}
    .controls input[type="range"]{width:140px}

    .ppt-embed{
      position:relative;width:100%;
      border-radius:14px;background:#fff; /* white matte to hide viewer padding */
      box-shadow:0 8px 24px rgba(0,0,0,.4);overflow:hidden;
    }
    .ppt-embed::before{content:"";display:block;padding-top:var(--ratio)} /* aspect box */

    /* masking stage */
    .viewer-stage{position:absolute;inset:0;overflow:hidden;background:#fff}
    .viewer{
      position:absolute;left:50%;top:50%;
      width:100%;height:100%;border:0;background:#fff;border-radius:0;
      transform-origin:center center;
      transform:
        translate(-50%,-50%)
        translate(var(--shiftX), var(--shiftY))
        scale(var(--zoom));
    }

    .note{color:var(--muted);font-size:13px;margin-top:8px}
    .warn{color:#ffd5d5}
  </style>
</head>
<body>
  <div class="bg-animated" aria-hidden="true"></div>
  <div id="scroll-bar"><div id="scroll-bar-fill"></div></div>

  <div class="site">
    <header>
      <nav>
        <div class="brand">
          <div class="logo">AC</div>
          <div>
            <h1>Alessandro Cervantes</h1>
            <p>E-Portfolio</p>
          </div>
        </div>
        <div class="nav-links">
          <button class="btn primary" id="contactBtn">Contact</button>
          <button class="btn" onclick="window.location='index.html'">Home</button>
          <button class="btn" onclick="window.location='marketable.html'">Marketable Skills</button>
          <button class="btn" onclick="window.location='community.html'">Community Engagement</button>
          <button class="btn active" onclick="window.location='career.html'">Career</button>
        </div>
      </nav>
    </header>

    <main>
      <h1 style="text-align:center;font-family:'Playfair Display';font-size:42px;margin-bottom:24px;">
        <span id="pageTitle">Career</span>
      </h1>

      <section class="section ppt-card">
        <h2>Political Science Career Project</h2>

        <div class="ppt-actions">
          <a id="downloadBtn" class="btn" href="Career_Project_Political_Science.pptx" download>Download .pptx</a>
          <a id="openOffice" class="btn">Open in Office Viewer</a>
          <a id="openGView" class="btn">Open in Google Viewer</a>
          <a id="openPDF" class="btn">Open PDF</a>
          <span class="spacer"></span>

          <div class="controls">
            <!-- Aspect presets -->
            <div class="group">
              <span class="btn" data-preset="16:9">16:9</span>
              <span class="btn" data-preset="16:10">16:10</span>
              <span class="btn" data-preset="3:2">3:2</span>
              <span class="btn" data-preset="4:3">4:3</span>
              <span class="btn" data-preset="5:4">5:4</span>
              <span class="btn" data-preset="1:1">1:1</span>
              <span class="btn" data-preset="A">A-series</span>
            </div>

            <!-- Exact slide size (inches) -->
            <div class="group">
              <label>Exact Size (in):</label>
              <input id="wIn" type="number" min="1" step="0.01" placeholder="Width">
              <span>×</span>
              <input id="hIn" type="number" min="1" step="0.01" placeholder="Height">
              <button class="btn" id="applyExact">Apply</button>
            </div>

            <!-- Fit + Zoom + Offset -->
            <div class="group">
              <label>Fit:</label>
              <select id="fitMode">
                <option value="contain" selected>Contain (no crop)</option>
                <option value="cover">Cover (fill)</option>
              </select>
            </div>
            <div class="group" id="coverTools" style="display:none">
              <label>Zoom</label>
              <input id="zoomRange" type="range" min="100" max="140" value="105">
              <span id="zoomVal">105%</span>
              <label>X</label>
              <input id="shiftX" type="range" min="-60" max="60" value="0">
              <label>Y</label>
              <input id="shiftY" type="range" min="-60" max="60" value="0">
            </div>
          </div>
        </div>

        <div class="ppt-embed" id="pptEmbed">
          <div class="viewer-stage">
            <iframe id="viewer" class="viewer" allowfullscreen referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </div>

        <div class="note warn" id="statusMsg" style="display:none"></div>
      </section>
    </main>

    <footer>
      <div style="text-align:center;padding:20px 0;color:var(--muted)">
        © <strong>Alessandro Cervantes</strong> — E-Portfolio
      </div>
    </footer>
  </div>

  <script>
    // reveal
    function reveal(){ document.querySelectorAll('.section').forEach((el,i)=>setTimeout(()=>el.classList.add('show'), i*200)); }
    window.addEventListener('load',reveal);
    // typewriter
    (function(){ const el=document.getElementById('pageTitle'); const t=el.textContent.trim(); el.textContent=''; let i=0; const h=setInterval(()=>{ el.textContent+=t.charAt(i++); if(i>=t.length) clearInterval(h); },40); })();
    // scroll bar
    const scrollBarFill=document.getElementById('scroll-bar-fill');
    window.addEventListener('scroll',()=>{ const st=window.scrollY, dh=document.body.scrollHeight-window.innerHeight; scrollBarFill.style.height=(st/dh)*100+'%'; });
    document.getElementById('contactBtn').addEventListener('click',()=>{ window.location.href='index.html#contact'; });

    // ------- embed pipeline (Office -> Google -> PDF -> Object) -------
    (function(){
      const fileBase = 'Career_Project_Political_Science';
      const pptx = fileBase + '.pptx';
      const pdf  = fileBase + '.pdf';

      const status = document.getElementById('statusMsg');
      const viewer = document.getElementById('viewer');

      const absolute = new URL(pptx, window.location.href).href;
      const officeEmbed = 'https://view.officeapps.live.com/op/embed.aspx?src='
                        + encodeURIComponent(absolute)
                        + '&em=2&wdAllowInteractivity=1&wdDownloadButton=0&wdProgressiveLoading=1';
      const gviewEmbed = 'https://docs.google.com/gview?embedded=1&url=' + encodeURIComponent(absolute);

      function show(msg){ status.style.display='block'; status.textContent=msg; }

      async function tryOffice(){
        return new Promise(res=>{
          viewer.src = officeEmbed;
          show('Loading Office Web Viewer…');
          let done=false; const to=setTimeout(()=>{ if(!done) res(false); }, 2500);
          viewer.addEventListener('load', ()=>{ done=true; clearTimeout(to); res(true); }, {once:true});
          viewer.addEventListener('error',()=>{ done=true; clearTimeout(to); res(false); }, {once:true});
        });
      }
      async function tryGoogle(){
        return new Promise(res=>{
          viewer.src = gviewEmbed;
          show('Office unavailable, trying Google Viewer…');
          let done=false; const to=setTimeout(()=>{ if(!done) res(false); }, 2500);
          viewer.addEventListener('load', ()=>{ done=true; clearTimeout(to); res(true); }, {once:true});
          viewer.addEventListener('error',()=>{ done=true; clearTimeout(to); res(false); }, {once:true});
        });
      }
      async function tryPDF(){
        try{
          const head = await fetch(pdf,{method:'HEAD'});
          if(head.ok){ viewer.src = pdf + '#view=FitH&zoom=page-width'; show('Using PDF fallback (fit width).'); return true; }
        }catch(_){}
        return false;
      }
      function tryObject(){
        const stage = viewer.parentElement;
        stage.innerHTML = '<object class="viewer" type="application/vnd.openxmlformats-officedocument.presentationml.presentation" data="'+pptx+'"><p style="padding:16px">Preview unavailable. <a href="'+pptx+'">Download</a>.</p></object>';
        show('Preview blocked by host or private file. Use the buttons above.');
      }

      (async function run(){
        if (await tryOffice()) return;
        if (await tryGoogle()) return;
        if (await tryPDF())   return;
        tryObject();
        if (location.protocol==='file:'){ show('You are viewing locally. Host via https or use the PDF fallback.'); }
      })();

      // Buttons
      document.getElementById('downloadBtn').href = pptx;
      document.getElementById('openOffice').href = officeEmbed; document.getElementById('openOffice').target = '_blank';
      document.getElementById('openGView').href  = gviewEmbed;  document.getElementById('openGView').target  = '_blank';
      document.getElementById('openPDF').href    = pdf;         document.getElementById('openPDF').target    = '_blank';
    })();

    // ------- Aspect presets + Exact size + Cover tools -------
    (function(){
      const presets = {
        '16:9': 9/16, '16:10': 10/16, '3:2': 2/3, '4:3': 3/4, '5:4': 4/5, '1:1': 1, 'A': Math.SQRT1_2
      };
      document.querySelectorAll('[data-preset]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const key = btn.getAttribute('data-preset');
          const pct = (presets[key] * 100).toFixed(6) + '%';
          document.documentElement.style.setProperty('--ratio', pct);
        });
      });

      // Exact slide size (inches) -> ratio
      document.getElementById('applyExact').addEventListener('click', ()=>{
        const w = parseFloat(document.getElementById('wIn').value);
        const h = parseFloat(document.getElementById('hIn').value);
        if(w>0 && h>0){
          const pct = (h / w) * 100; // height/width *100%
          document.documentElement.style.setProperty('--ratio', pct + '%');
        }
      });

      const fitMode  = document.getElementById('fitMode');
      const tools    = document.getElementById('coverTools');
      const zoom     = document.getElementById('zoomRange');
      const zoomVal  = document.getElementById('zoomVal');
      const shiftX   = document.getElementById('shiftX');
      const shiftY   = document.getElementById('shiftY');

      function applyFit(){
        if(fitMode.value==='cover'){
          tools.style.display='flex';
          document.documentElement.style.setProperty('--zoom', (parseInt(zoom.value,10)/100).toString());
          document.documentElement.style.setProperty('--shiftX', shiftX.value+'px');
          document.documentElement.style.setProperty('--shiftY', shiftY.value+'px');
        }else{
          tools.style.display='none';
          document.documentElement.style.setProperty('--zoom', '1');
          document.documentElement.style.setProperty('--shiftX', '0px');
          document.documentElement.style.setProperty('--shiftY', '0px');
        }
      }
      fitMode.addEventListener('change', applyFit);
      zoom.addEventListener('input', ()=>{ zoomVal.textContent = zoom.value+'%'; document.documentElement.style.setProperty('--zoom', (parseInt(zoom.value,10)/100).toString()); });
      shiftX.addEventListener('input', ()=>{ document.documentElement.style.setProperty('--shiftX', shiftX.value+'px'); });
      shiftY.addEventListener('input', ()=>{ document.documentElement.style.setProperty('--shiftY', shiftY.value+'px'); });
      applyFit();
    })();
  </script>
</body>
</html>
