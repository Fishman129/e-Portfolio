<!doctype html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" href="favicon.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Career — Alessandro Cervantes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --bg1:linear-gradient(120deg,#071429 0%, #0b2b3a 35%, #0f3b2f 100%); --glass:rgba(255,255,255,0.06); --accent:#6be3b6; --muted:rgba(255,255,255,0.7);
      /* default aspect ratio is 16:9 */ --ratio:56.25%;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:#eef6f5;-webkit-font-smoothing:antialiased}
    .site{min-height:100vh;display:flex;flex-direction:column}
    header{backdrop-filter:blur(6px);background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));position:sticky;top:0;z-index:40;border-bottom:1px solid rgba(255,255,255,0.03)}
    nav{display:flex;align-items:center;justify-content:space-between;padding:18px 36px;max-width:1200px;margin:0 auto}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{width:54px;height:54px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#4bd8ff);display:flex;align-items:center;justify-content:center;color:#042;font-weight:800;font-family:'Playfair Display';box-shadow:0 6px 18px rgba(11,22,30,0.6)}
    .brand h1{margin:0;font-family:'Playfair Display';font-weight:700;letter-spacing:0.6px}
    .brand p{margin:0;color:var(--muted);font-size:13px}
    .nav-links{display:flex;gap:12px;align-items:center}
    .btn{padding:10px 14px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);cursor:pointer;font-weight:600;transition:all .2s}
    .btn.primary{background:linear-gradient(90deg,var(--accent),#4bd8ff);color:#022;border:none;box-shadow:0 8px 30px rgba(11,22,30,0.45)}
    .btn:hover{transform:scale(1.05)}
    .btn.active{border-color:var(--accent);color:#eafdf7}
    main{max-width:1200px;margin:36px auto;padding:0 36px 80px}
    .section{background:var(--glass);padding:22px;border-radius:14px;border:1px solid rgba(255,255,255,0.03);min-height:120px;opacity:0;transform:translateY(20px);transition:all .8s cubic-bezier(.2,.9,.2,1)}
    .section.show{opacity:1;transform:none}
    .section:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 12px 36px rgba(0,0,0,.35)}
    .section h2{font-family:'Playfair Display';margin:0 0 8px}
    .section p{color:var(--muted);line-height:1.6}
    .bg-animated{position:fixed;inset:0;z-index:-1;pointer-events:none;background:linear-gradient(270deg,#0b2b3a,#0f3b2f,#071429,#123d52);background-size:800% 800%;animation:gradientShift 20s ease infinite}
    @keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    #scroll-bar{position:fixed;top:0;right:20px;width:12px;height:100%;background:rgba(255,255,255,0.05);border-radius:6px;z-index:9999;overflow:hidden}
    #scroll-bar-fill{width:100%;height:0%;background:linear-gradient(180deg,var(--accent),#4bd8ff);border-radius:6px;transition:height .2s}
    html{scrollbar-width:none} body::-webkit-scrollbar{width:0;background:transparent}

    .ppt-card{padding:22px}
    .ppt-actions{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px}
    .ppt-actions .right{margin-left:auto;display:flex;gap:10px}
    .ppt-embed{
      position:relative;width:100%;
      /* keep the outer card rounded, but the inner viewer squared -> no visible dark corners */
      border-radius:14px;background:#fff; /* white background to kill “black bars” if viewer leaves gaps */
      box-shadow:0 8px 24px rgba(0,0,0,.4);
      overflow:hidden;
    }
    .ppt-embed::before{content:"";display:block;padding-top:var(--ratio)} /* responsive aspect box */
    .ppt-embed .viewer{
      position:absolute;inset:0;width:100%;height:100%;border:0;background:#fff; /* white viewer backdrop */
      border-radius:0; /* square inside to avoid dark rounded edges from the iframe */
      transform:translateZ(0);image-rendering:-webkit-optimize-contrast; /* slight clarity boost for some browsers */
    }
    /* Full-height on tall screens without leaving empty strips */
    @media (min-height:800px){
      .ppt-embed{max-height:calc(100vh - 260px)} /* header/title/margins accounted for */
    }

    .note{color:var(--muted);font-size:14px;margin-top:10px}
    .hint{font-size:13px;color:#bfeee0;margin-top:8px}
    .warn{color:#ffd5d5}
  </style>
</head>
<body>
  <div class="bg-animated" aria-hidden="true"></div>
  <div id="scroll-bar"><div id="scroll-bar-fill"></div></div>

  <div class="site">
    <header>
      <nav>
        <div class="brand">
          <div class="logo">AC</div>
          <div>
            <h1>Alessandro Cervantes</h1>
            <p>E-Portfolio</p>
          </div>
        </div>
        <div class="nav-links">
          <button class="btn primary" id="contactBtn">Contact</button>
          <button class="btn" onclick="window.location='index.html'">Home</button>
          <button class="btn" onclick="window.location='marketable.html'">Marketable Skills</button>
          <button class="btn" onclick="window.location='community.html'">Community Engagement</button>
          <button class="btn active" onclick="window.location='career.html'">Career</button>
        </div>
      </nav>
    </header>

    <main>
      <h1 style="text-align:center;font-family:'Playfair Display';font-size:42px;margin-bottom:24px;">
        <span id="pageTitle">Career</span>
      </h1>

      <section class="section ppt-card">
        <h2>Political Science Career Project</h2>

        <div class="ppt-actions">
          <a id="downloadBtn" class="btn" href="Career_Project_Political_Science.pptx" download>Download .pptx</a>
          <a id="openOffice" class="btn">Open in Office Viewer</a>
          <a id="openGView" class="btn">Open in Google Viewer</a>
          <a id="openPDF" class="btn">Open PDF</a>

          <div class="right">
            <span class="btn" id="ratio169">Aspect: 16:9</span>
            <span class="btn" id="ratio43">Aspect: 4:3</span>
          </div>
        </div>

        <div class="ppt-embed" id="pptEmbed" data-aspect="16:9"></div>

        <div class="hint" id="statusMsg" style="display:none"></div>
      </section>
    </main>

    <footer>
      <div style="text-align:center;padding:20px 0;color:var(--muted)">
        © <strong>Alessandro Cervantes</strong> — E-Portfolio
      </div>
    </footer>
  </div>

  <script>
    // Reveal animation
    function reveal(){ document.querySelectorAll('.section').forEach((el,i)=>setTimeout(()=>el.classList.add('show'), i*200)); }
    window.addEventListener('load',reveal);

    // Typewriter for title
    (function(){
      const titleEl = document.getElementById('pageTitle');
      const t = titleEl.textContent.trim(); titleEl.textContent = '';
      let i=0; const h=setInterval(()=>{ titleEl.textContent += t.charAt(i++); if(i>=t.length) clearInterval(h); },40);
    })();

    // Scroll progress bar
    const scrollBarFill=document.getElementById('scroll-bar-fill');
    window.addEventListener('scroll',()=>{ const st=window.scrollY, dh=document.body.scrollHeight-window.innerHeight; scrollBarFill.style.height=(st/dh)*100+'%'; });

    // Contact anchor
    document.getElementById('contactBtn').addEventListener('click',()=>{ window.location.href='index.html#contact'; });

    // ---------- Clean, crisp, no-gutter embedding ----------
    (function(){
      const fileBase = 'Career_Project_Political_Science';
      const pptx = fileBase + '.pptx';
      const pdf  = fileBase + '.pdf';

      const embed  = document.getElementById('pptEmbed');
      const status = document.getElementById('statusMsg');

      // Aspect toggles (set --ratio: 56.25% for 16:9, 75% for 4:3)
      function setAspect(r){
        document.documentElement.style.setProperty('--ratio', r==='4:3' ? '75%' : '56.25%');
        embed.dataset.aspect = r;
      }
      document.getElementById('ratio169').onclick = ()=> setAspect('16:9');
      document.getElementById('ratio43').onclick  = ()=> setAspect('4:3');

      const absolute = new URL(pptx, window.location.href).href;
      const officeEmbed = 'https://view.officeapps.live.com/op/embed.aspx?src=' + encodeURIComponent(absolute) + '&wdProgressiveLoading=1';
      const gviewEmbed  = 'https://docs.google.com/gview?embedded=1&url=' + encodeURIComponent(absolute);

      // Buttons
      document.getElementById('downloadBtn').href = pptx;
      document.getElementById('openOffice').href = officeEmbed.replace('/op/embed.aspx','/op/view.aspx');
      document.getElementById('openOffice').target = '_blank';
      document.getElementById('openGView').href = gviewEmbed;
      document.getElementById('openGView').target = '_blank';
      document.getElementById('openPDF').href = pdf;
      document.getElementById('openPDF').target = '_blank';

      // Helper
      function mountViewer(src, isPDF=false){
        embed.innerHTML='';
        const el = document.createElement('iframe');
        el.className = 'viewer';
        el.src = src;
        // For PDFs, make the browser viewer fit width (crisper, no black)
        if(isPDF){
          // Works in most browsers:
          el.src = src + '#view=FitH&zoom=page-width';
        }
        embed.appendChild(el);
      }

      function tryPDF(){
        // Prefer crisp PDF if present
        return fetch(pdf, {method:'HEAD'}).then(r=>{
          if(r.ok){ mountViewer(pdf, true); status.style.display='block'; status.textContent='Using high-quality PDF (fit to width).'; return true; }
          return false;
        }).catch(()=> false);
      }

      function tryOffice(){
        return new Promise(res=>{
          mountViewer(officeEmbed);
          status.style.display='block'; status.textContent='Trying Office Web Viewer…';
          // If it’s blank/blocked, we’ll switch after 2.5s
          setTimeout(()=>res(false), 2500);
        });
      }

      function tryGoogle(){
        mountViewer(gviewEmbed);
        status.style.display='block'; status.textContent='Falling back to Google Viewer.';
      }

      (async function run(){
        if (await tryPDF()) return;               // best quality, no gutters
        const ok = await tryOffice(); if (ok) return;
        tryGoogle();
        // If viewing locally, warn once
        if (location.protocol === 'file:'){
          status.innerHTML = 'You are viewing this locally. Online viewers cannot read local files. Export a PDF and refresh, or host the files via https.';
        }
      })();
    })();
  </script>
</body>
</html>
